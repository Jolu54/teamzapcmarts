{"ast":null,"code":"import _slicedToArray from\"/home/deploy/teamzap/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/home/deploy/teamzap/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"/home/deploy/teamzap/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React,{useState,useContext,useEffect}from\"react\";import clsx from\"clsx\";import moment from\"moment\";import{makeStyles,Drawer,AppBar,Toolbar,List,Typography,Divider,MenuItem,IconButton,Menu,useTheme,useMediaQuery}from\"@material-ui/core\";import MenuIcon from\"@material-ui/icons/Menu\";import ChevronLeftIcon from\"@material-ui/icons/ChevronLeft\";import AccountCircle from\"@material-ui/icons/AccountCircle\";import CachedIcon from\"@material-ui/icons/Cached\";import MainListItems from\"./MainListItems\";import NotificationsPopOver from\"../components/NotificationsPopOver\";import NotificationsVolume from\"../components/NotificationsVolume\";import UserModal from\"../components/UserModal\";import{AuthContext}from\"../context/Auth/AuthContext\";import BackdropLoading from\"../components/BackdropLoading\";import DarkMode from\"../components/DarkMode\";import{i18n}from\"../translate/i18n\";import toastError from\"../errors/toastError\";import AnnouncementsPopover from\"../components/AnnouncementsPopover\";import logo from\"../assets/logo.png\";import{socketConnection}from\"../services/socket\";import ChatPopover from\"../pages/Chat/ChatPopover\";import{useDate}from\"../hooks/useDate\";import ColorModeContext from\"../layout/themeContext\";import Brightness4Icon from'@material-ui/icons/Brightness4';import Brightness7Icon from'@material-ui/icons/Brightness7';var drawerWidth=240;var useStyles=makeStyles(function(theme){var _root,_drawerPaperClose,_logo;return{root:(_root={display:\"flex\",height:\"100vh\"},_defineProperty(_root,theme.breakpoints.down(\"sm\"),{height:\"calc(100vh - 56px)\"}),_defineProperty(_root,\"backgroundColor\",theme.palette.fancyBackground),_defineProperty(_root,'& .MuiButton-outlinedPrimary',{color:theme.mode==='light'?'#FFF':'#FFF',backgroundColor:theme.mode==='light'?'#2DDD7F':'#1c1c1c'//border: theme.mode === 'light' ? '1px solid rgba(0 124 102)' : '1px solid rgba(255, 255, 255, 0.5)',\n}),_defineProperty(_root,'& .MuiTab-textColorPrimary.Mui-selected',{color:theme.mode==='light'?'#2DDD7F':'#FFF'}),_root),avatar:{width:\"100%\"},toolbar:{paddingRight:24,// keep right padding when drawer closed\ncolor:theme.palette.dark.main,background:theme.palette.barraSuperior},toolbarIcon:_defineProperty({display:\"flex\",alignItems:\"center\",justifyContent:\"space-between\",padding:\"0 8px\",minHeight:\"48px\"},theme.breakpoints.down(\"sm\"),{height:\"48px\"}),appBar:{zIndex:theme.zIndex.drawer+1,transition:theme.transitions.create([\"width\",\"margin\"],{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.leavingScreen})},appBarShift:_defineProperty({marginLeft:drawerWidth,width:\"calc(100% - \".concat(drawerWidth,\"px)\"),transition:theme.transitions.create([\"width\",\"margin\"],{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.enteringScreen})},theme.breakpoints.down(\"sm\"),{display:\"none\"}),menuButton:{marginRight:36},menuButtonHidden:{display:\"none\"},title:{flexGrow:1,fontSize:14,color:\"white\"},drawerPaper:_objectSpread(_defineProperty({position:\"relative\",whiteSpace:\"nowrap\",width:drawerWidth,transition:theme.transitions.create(\"width\",{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.enteringScreen})},theme.breakpoints.down(\"sm\"),{width:\"100%\"}),theme.scrollbarStylesSoft),drawerPaperClose:(_drawerPaperClose={overflowX:\"hidden\",transition:theme.transitions.create(\"width\",{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.leavingScreen}),width:theme.spacing(7)},_defineProperty(_drawerPaperClose,theme.breakpoints.up(\"sm\"),{width:theme.spacing(9)}),_defineProperty(_drawerPaperClose,theme.breakpoints.down(\"sm\"),{width:\"100%\"}),_drawerPaperClose),appBarSpacer:{minHeight:\"48px\"},content:{flex:1,overflow:\"auto\"},container:{paddingTop:theme.spacing(4),paddingBottom:theme.spacing(4)},paper:{padding:theme.spacing(2),display:\"flex\",overflow:\"auto\",flexDirection:\"column\"},containerWithScroll:_objectSpread({flex:1,padding:theme.spacing(1),overflowY:\"scroll\"},theme.scrollbarStyles),NotificationsPopOver:{// color: theme.barraSuperior.secondary.main,\n},logo:(_logo={width:\"80%\",height:\"auto\",maxWidth:180},_defineProperty(_logo,theme.breakpoints.down(\"sm\"),{width:\"auto\",height:\"80%\",maxWidth:180}),_defineProperty(_logo,\"logo\",theme.logo),_logo)};});var LoggedInLayout=function LoggedInLayout(_ref){var _user$company,_user$company2,_user$company3,_user$company4;var children=_ref.children,themeToggle=_ref.themeToggle;var classes=useStyles();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),userModalOpen=_useState2[0],setUserModalOpen=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),anchorEl=_useState4[0],setAnchorEl=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),menuOpen=_useState6[0],setMenuOpen=_useState6[1];var _useContext=useContext(AuthContext),handleLogout=_useContext.handleLogout,loading=_useContext.loading;var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),drawerOpen=_useState8[0],setDrawerOpen=_useState8[1];var _useState9=useState(\"permanent\"),_useState10=_slicedToArray(_useState9,2),drawerVariant=_useState10[0],setDrawerVariant=_useState10[1];// const [dueDate, setDueDate] = useState(\"\");\nvar _useContext2=useContext(AuthContext),user=_useContext2.user;var theme=useTheme();var _useContext3=useContext(ColorModeContext),colorMode=_useContext3.colorMode;var greaterThenSm=useMediaQuery(theme.breakpoints.up(\"sm\"));var _useState11=useState(localStorage.getItem(\"volume\")||1),_useState12=_slicedToArray(_useState11,2),volume=_useState12[0],setVolume=_useState12[1];var _useDate=useDate(),dateToClient=_useDate.dateToClient;//################### CODIGOS DE TESTE #########################################\n// useEffect(() => {\n//   navigator.getBattery().then((battery) => {\n//     console.log(`Battery Charging: ${battery.charging}`);\n//     console.log(`Battery Level: ${battery.level * 100}%`);\n//     console.log(`Charging Time: ${battery.chargingTime}`);\n//     console.log(`Discharging Time: ${battery.dischargingTime}`);\n//   })\n// }, []);\n// useEffect(() => {\n//   const geoLocation = navigator.geolocation\n//   geoLocation.getCurrentPosition((position) => {\n//     let lat = position.coords.latitude;\n//     let long = position.coords.longitude;\n//     console.log('latitude: ', lat)\n//     console.log('longitude: ', long)\n//   })\n// }, []);\n// useEffect(() => {\n//   const nucleos = window.navigator.hardwareConcurrency;\n//   console.log('Nucleos: ', nucleos)\n// }, []);\n// useEffect(() => {\n//   console.log('userAgent', navigator.userAgent)\n//   if (\n//     navigator.userAgent.match(/Android/i)\n//     || navigator.userAgent.match(/webOS/i)\n//     || navigator.userAgent.match(/iPhone/i)\n//     || navigator.userAgent.match(/iPad/i)\n//     || navigator.userAgent.match(/iPod/i)\n//     || navigator.userAgent.match(/BlackBerry/i)\n//     || navigator.userAgent.match(/Windows Phone/i)\n//   ) {\n//     console.log('é mobile ', true) //celular\n//   }\n//   else {\n//     console.log('não é mobile: ', false) //nao é celular\n//   }\n// }, []);\n//##############################################################################\nuseEffect(function(){if(document.body.offsetWidth>600){setDrawerOpen(true);}},[]);useEffect(function(){if(document.body.offsetWidth<600){setDrawerVariant(\"temporary\");}else{setDrawerVariant(\"permanent\");}},[drawerOpen]);useEffect(function(){var companyId=localStorage.getItem(\"companyId\");var userId=localStorage.getItem(\"userId\");var socket=socketConnection({companyId:companyId});socket.on(\"company-\".concat(companyId,\"-auth\"),function(data){if(data.user.id===+userId){toastError(\"Sua conta foi acessada em outro computador.\");setTimeout(function(){localStorage.clear();window.location.reload();},1000);}});socket.emit(\"userStatus\");var interval=setInterval(function(){socket.emit(\"userStatus\");},1000*60*5);return function(){socket.disconnect();clearInterval(interval);};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var handleMenu=function handleMenu(event){setAnchorEl(event.currentTarget);setMenuOpen(true);};var handleCloseMenu=function handleCloseMenu(){setAnchorEl(null);setMenuOpen(false);};var handleOpenUserModal=function handleOpenUserModal(){setUserModalOpen(true);handleCloseMenu();};var handleClickLogout=function handleClickLogout(){handleCloseMenu();handleLogout();};var drawerClose=function drawerClose(){if(document.body.offsetWidth<600){setDrawerOpen(false);}};var handleRefreshPage=function handleRefreshPage(){window.location.reload(false);};var handleMenuItemClick=function handleMenuItemClick(){var _window=window,width=_window.innerWidth;if(width<=600){setDrawerOpen(false);}};var toggleColorMode=function toggleColorMode(){colorMode.toggleColorMode();};if(loading){return/*#__PURE__*/React.createElement(BackdropLoading,null);}return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(Drawer,{variant:drawerVariant,className:drawerOpen?classes.drawerPaper:classes.drawerPaperClose,classes:{paper:clsx(classes.drawerPaper,!drawerOpen&&classes.drawerPaperClose)},open:drawerOpen},/*#__PURE__*/React.createElement(\"div\",{className:classes.toolbarIcon},/*#__PURE__*/React.createElement(\"img\",{src:logo,className:classes.logo,alt:\"logo\"}),/*#__PURE__*/React.createElement(IconButton,{onClick:function onClick(){return setDrawerOpen(!drawerOpen);}},/*#__PURE__*/React.createElement(ChevronLeftIcon,null))),/*#__PURE__*/React.createElement(Divider,null),/*#__PURE__*/React.createElement(List,{className:classes.containerWithScroll},/*#__PURE__*/React.createElement(MainListItems,{drawerClose:drawerClose,collapsed:!drawerOpen})),/*#__PURE__*/React.createElement(Divider,null)),/*#__PURE__*/React.createElement(UserModal,{open:userModalOpen,onClose:function onClose(){return setUserModalOpen(false);},userId:user===null||user===void 0?void 0:user.id}),/*#__PURE__*/React.createElement(AppBar,{position:\"absolute\",className:clsx(classes.appBar,drawerOpen&&classes.appBarShift),color:\"primary\"},/*#__PURE__*/React.createElement(Toolbar,{variant:\"dense\",className:classes.toolbar},/*#__PURE__*/React.createElement(IconButton,{edge:\"start\",variant:\"contained\",\"aria-label\":\"open drawer\",onClick:function onClick(){return setDrawerOpen(!drawerOpen);},className:clsx(classes.menuButton,drawerOpen&&classes.menuButtonHidden)},/*#__PURE__*/React.createElement(MenuIcon,null)),/*#__PURE__*/React.createElement(Typography,{component:\"h2\",variant:\"h6\",color:\"inherit\",noWrap:true,className:classes.title},greaterThenSm&&(user===null||user===void 0?void 0:user.profile)===\"admin\"&&(user===null||user===void 0?void 0:(_user$company=user.company)===null||_user$company===void 0?void 0:_user$company.dueDate)?/*#__PURE__*/React.createElement(React.Fragment,null,\"Ol\\xE1 \",/*#__PURE__*/React.createElement(\"b\",null,user.name),\", Bem vindo a \",/*#__PURE__*/React.createElement(\"b\",null,user===null||user===void 0?void 0:(_user$company2=user.company)===null||_user$company2===void 0?void 0:_user$company2.name),\"! (Ativo at\\xE9 \",dateToClient(user===null||user===void 0?void 0:(_user$company3=user.company)===null||_user$company3===void 0?void 0:_user$company3.dueDate),\")\"):/*#__PURE__*/React.createElement(React.Fragment,null,\"Ol\\xE1  \",/*#__PURE__*/React.createElement(\"b\",null,user.name),\", Bem vindo a \",/*#__PURE__*/React.createElement(\"b\",null,user===null||user===void 0?void 0:(_user$company4=user.company)===null||_user$company4===void 0?void 0:_user$company4.name),\"!\")),/*#__PURE__*/React.createElement(IconButton,{edge:\"start\",onClick:toggleColorMode},theme.mode==='dark'?/*#__PURE__*/React.createElement(Brightness7Icon,{style:{color:\"white\"}}):/*#__PURE__*/React.createElement(Brightness4Icon,{style:{color:\"white\"}})),/*#__PURE__*/React.createElement(NotificationsVolume,{setVolume:setVolume,volume:volume}),/*#__PURE__*/React.createElement(IconButton,{onClick:handleRefreshPage,\"aria-label\":i18n.t(\"mainDrawer.appBar.refresh\"),color:\"inherit\"},/*#__PURE__*/React.createElement(CachedIcon,{style:{color:\"white\"}})),user.id&&/*#__PURE__*/React.createElement(NotificationsPopOver,{volume:volume}),/*#__PURE__*/React.createElement(AnnouncementsPopover,null),/*#__PURE__*/React.createElement(ChatPopover,null),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"account of current user\",\"aria-controls\":\"menu-appbar\",\"aria-haspopup\":\"true\",onClick:handleMenu,variant:\"contained\",style:{color:\"white\"}},/*#__PURE__*/React.createElement(AccountCircle,null)),/*#__PURE__*/React.createElement(Menu,{id:\"menu-appbar\",anchorEl:anchorEl,getContentAnchorEl:null,anchorOrigin:{vertical:\"bottom\",horizontal:\"right\"},transformOrigin:{vertical:\"top\",horizontal:\"right\"},open:menuOpen,onClose:handleCloseMenu},/*#__PURE__*/React.createElement(MenuItem,{onClick:handleOpenUserModal},i18n.t(\"mainDrawer.appBar.user.profile\")),/*#__PURE__*/React.createElement(MenuItem,{onClick:handleClickLogout},i18n.t(\"mainDrawer.appBar.user.logout\")))))),/*#__PURE__*/React.createElement(\"main\",{className:classes.content},/*#__PURE__*/React.createElement(\"div\",{className:classes.appBarSpacer}),children?children:null));};export default LoggedInLayout;","map":null,"metadata":{},"sourceType":"module"}